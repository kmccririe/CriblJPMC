exports.name="Destination Backpressure Activated";exports.type="metric";exports.category="destinations";let name;let __workerGroup;let timeWindow;exports.init=e=>{const r=e.conf||{};({name,__workerGroup,timeWindow}=r);timeWindow=timeWindow||"60s"};exports.build=()=>{let e="";let r=`_metric === 'backpressure.outputs' && output === '${name}'`;if(__workerGroup){r=`${r} && __worker_group === '${__workerGroup}'`;e=` in group ${__workerGroup}`}return{filter:r,pipeline:{conf:{functions:[{id:"aggregation",conf:{timeWindow,aggregations:["max(_value).as(backpressure_type)"],lagTolerance:"20s",idleTimeLimit:"20s"}},{id:"drop",filter:"(typeof backpressure_type === 'undefined' || backpressure_type === 0)",conf:{}},{id:"eval",filter:"backpressure_type === 1",conf:{add:[{name:"output",value:`'${name}'`},{name:"_metric",value:"'backpressure.outputs'"},{name:"_raw",value:`'Backpressure (blocking) is engaged for destination ${name}${e}'`}]}},{id:"eval",filter:"backpressure_type === 2",conf:{add:[{name:"output",value:`'${name}'`},{name:"_metric",value:"'backpressure.outputs'"},{name:"_raw",value:`'Backpressure (dropping) is engaged for destination ${name}${e}'`}]}}]}}}};